"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1369],{94513:(e,a,t)=>{t.d(a,{A:()=>i});var r=t(20475);t(20107);var n=t(93557),s=t(42541),o=t(49573),l=t(12607);let i=e=>{let{open:a,onClose:t,onDismiss:i,usagePercentage:c,currentUsage:d,monthlyLimit:u,remaining:g,onOpenSettings:m}=e,h=c>=100,f=c>=95;return(0,r.jsx)(n.lG,{open:a,onOpenChange:t,children:(0,r.jsxs)(n.Cf,{className:"sm:max-w-[500px]",children:[(0,r.jsxs)(n.c7,{children:[(0,r.jsx)(n.L3,{className:"flex items-center gap-2",children:h?"Data Limit Exceeded":f?"Approaching Data Limit":"Data Usage Warning"}),(0,r.jsx)(n.rr,{children:h?"You have exceeded your monthly data limit. Your connection may be throttled or additional charges may apply.":f?"You're very close to reaching your monthly data limit. Consider monitoring your usage closely.":"You're approaching your monthly data usage limit. You may want to monitor your usage more carefully."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:"Current Usage"}),(0,r.jsx)("span",{className:"font-medium",children:d})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 dark:bg-gray-700",children:(0,r.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(h?"bg-red-500":f?"bg-orange-500":"bg-yellow-500"),style:{width:"".concat(Math.min(c,100),"%")}})}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{children:"0 GB"}),(0,r.jsx)("span",{children:u})]})]}),(0,r.jsxs)(o.Fc,{variant:h?"destructive":"default",children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),(0,r.jsx)(o.XL,{className:"font-bold",children:h?"Limit Exceeded":f?"Approaching Limit":"Usage Warning"}),(0,r.jsx)(o.TN,{children:h?(0,r.jsx)(r.Fragment,{children:"You've used all of your monthly data allowance. Consider upgrading your plan or enabling data-saving features."}):f?(0,r.jsx)(r.Fragment,{children:"You have very little data remaining. Monitor your usage carefully to avoid overages."}):(0,r.jsx)(r.Fragment,{children:"You're approaching your monthly limit. Consider adjusting your usage patterns or increasing your limit."})})]})]}),(0,r.jsx)(n.Es,{children:(0,r.jsx)(s.$,{onClick:i,variant:h?"destructive":"default",children:"Don't Show Again This Month"})})]})})}},49573:(e,a,t)=>{t.d(a,{Fc:()=>i,TN:()=>d,XL:()=>c});var r=t(20475),n=t(20107),s=t(29395),o=t(22250);let l=(0,s.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=n.forwardRef((e,a)=>{let{className:t,variant:n,...s}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,o.cn)(l({variant:n}),t),...s})});i.displayName="Alert";let c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("h5",{ref:a,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",t),...n})});c.displayName="AlertTitle";let d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",t),...n})});d.displayName="AlertDescription"},93557:(e,a,t)=>{t.d(a,{Cf:()=>m,Es:()=>f,HM:()=>u,L3:()=>p,c7:()=>h,lG:()=>i,rr:()=>w,zM:()=>c});var r=t(20475),n=t(20107),s=t(60241),o=t(7197),l=t(22250);let i=s.bL,c=s.l9,d=s.ZL,u=s.bm,g=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.hJ,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});g.displayName=s.hJ.displayName;let m=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(g,{}),(0,r.jsxs)(s.UC,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[n,(0,r.jsxs)(s.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(o.MKb,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.UC.displayName;let h=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};h.displayName="DialogHeader";let f=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};f.displayName="DialogFooter";let p=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.hE,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});p.displayName=s.hE.displayName;let w=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.VY,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...n})});w.displayName=s.VY.displayName},36760:(e,a,t)=>{t.d(a,{E:()=>s});var r=t(20475),n=t(22250);function s(e){let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-primary/10",a),...t})}},16028:(e,a,t)=>{t.d(a,{A:()=>s});var r=t(20107),n=t(32857);let s=()=>{let[e,a]=(0,r.useState)({enabled:!1,monthlyLimit:0x280000000,backupInterval:12,autoBackupEnabled:!1,resetDay:1,warningThreshold:90,warningShown:!1,warningThresholdShown:!1,warningOverlimitShown:!1,lastBackup:0}),[t,s]=(0,r.useState)({upload:0,download:0,total:0}),[o,l]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!1),{toast:g}=(0,n.dj)(),m=(0,r.useCallback)(e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][a]},[]),h=(0,r.useCallback)(e=>0===e?"Never":new Date(1e3*e).toLocaleString(),[]),f=(0,r.useCallback)(()=>0===e.monthlyLimit?0:Math.min(t.total/e.monthlyLimit*100,100),[t.total,e.monthlyLimit]),p=(0,r.useCallback)(()=>{if(!e.enabled)return!1;let a=f();return a>=100&&!e.warningOverlimitShown||a>=e.warningThreshold&&!e.warningThresholdShown},[e.enabled,e.warningThresholdShown,e.warningOverlimitShown,e.warningThreshold,f]),w=(0,r.useCallback)(async()=>{try{c(null);let e=await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/config_manager.sh");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();a(t.config);let r=t.usage;try{let e=await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/fetch_realtime_usage.sh");if(e.ok){let a=await e.json();void 0===a.enabled||a.error?a.error&&console.warn("Real-time usage data error:",a.error):r={upload:a.upload||0,download:a.download||0,total:a.total||0}}}catch(e){console.warn("Real-time usage data unavailable, using stored data:",e)}if(s(r),t.config.enabled){let e=r.total/t.config.monthlyLimit*100;e>=100&&!t.config.warningOverlimitShown?u(!0):e>=t.config.warningThreshold&&!t.config.warningThresholdShown&&u(!0)}}catch(e){console.error("Error fetching data usage data:",e),c(e instanceof Error?e.message:"Failed to fetch data")}finally{l(!1)}},[]),x=(0,r.useCallback)(async t=>{try{let r;c(null);let n="autoBackupEnabled"in t&&t.autoBackupEnabled!==e.autoBackupEnabled,s=await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/config_manager.sh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let o=await s.text();console.log("Raw response from config_manager:",o);try{r=JSON.parse(o)}catch(e){throw console.error("Failed to parse response as JSON:",e),console.error("Response text was:",o),Error("Invalid JSON response from server")}if("success"===r.status){if(n)try{(await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/config_manager.sh?action=toggle_backup&enabled=".concat(t.autoBackupEnabled),{method:"GET"})).ok||console.warn("Failed to toggle backup service, but config was saved")}catch(e){console.warn("Error toggling backup service:",e)}return a(e=>({...e,...t})),g({title:"Success",description:"Configuration updated successfully"}),!0}throw Error(r.message||"Update failed")}catch(e){return console.error("Error updating configuration:",e),c(e instanceof Error?e.message:"Failed to update configuration"),g({title:"Error",description:"Failed to update configuration",variant:"destructive"}),!1}},[g,e.autoBackupEnabled]),y=(0,r.useCallback)(async()=>{try{c(null);let e=await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/config_manager.sh?action=reset");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();if("success"===a.status)return s({upload:0,download:0,total:0}),u(!1),g({title:"Success",description:"Usage data reset successfully"}),!0;throw Error(a.message||"Reset failed")}catch(e){return console.error("Error resetting usage:",e),c(e instanceof Error?e.message:"Failed to reset usage data"),g({title:"Error",description:"Failed to reset usage data",variant:"destructive"}),!1}},[g]),b=(0,r.useCallback)(async()=>{try{c(null);let e=await fetch("/cgi-bin/quecmanager/experimental/data_usage_tracking/config_manager.sh?action=backup");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();if("success"===a.status)return g({title:"Success",description:"Backup created successfully"}),!0;throw Error(a.message||"Backup failed")}catch(e){return console.error("Error creating backup:",e),c(e instanceof Error?e.message:"Failed to create backup"),g({title:"Error",description:"Failed to create backup",variant:"destructive"}),!1}},[g]),v=(0,r.useCallback)(async()=>{let a=f();a>=100?await x({warningOverlimitShown:!0}):a>=e.warningThreshold&&await x({warningThresholdShown:!0}),u(!1)},[x,f,e.warningThreshold]),k=(0,r.useCallback)(()=>{u(!1)},[]);return(0,r.useEffect)(()=>{let a;return w(),e.enabled&&(a=setInterval(w,66e3)),()=>{a&&clearInterval(a)}},[w,e.enabled]),(0,r.useEffect)(()=>{p()&&u(!0)},[p]),{config:e,usage:t,loading:o,error:i,showWarning:d,usagePercentage:f(),formattedUsage:{upload:m(t.upload),download:m(t.download),total:m(t.total)},formattedLimit:m(e.monthlyLimit),remaining:m(Math.max(0,e.monthlyLimit-t.total)),updateConfig:x,resetUsage:y,createBackup:b,dismissWarning:v,closeWarning:k,refresh:w,formatBytes:m,formatDate:h}}}}]);