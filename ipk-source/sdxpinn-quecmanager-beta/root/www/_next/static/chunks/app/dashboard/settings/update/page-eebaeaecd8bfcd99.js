(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8529],{38224:(e,t,a)=>{Promise.resolve().then(a.bind(a,46458))},46458:(e,t,a)=>{"use strict";a.d(t,{default:()=>k});var s=a(20475),r=a(20107),n=a(72167),l=a(68100),i=a(59166),c=a(97801),d=a(42541),o=a(29395),u=a(22250);function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"empty",className:(0,u.cn)("flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"empty-header",className:(0,u.cn)("flex max-w-sm flex-col items-center gap-2 text-center",t),...a})}let p=(0,o.F)("mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0",{variants:{variant:{default:"bg-transparent",icon:"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6"}},defaultVariants:{variant:"default"}});function g(e){let{className:t,variant:a="default",...r}=e;return(0,s.jsx)("div",{"data-slot":"empty-icon","data-variant":a,className:(0,u.cn)(p({variant:a,className:t})),...r})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"empty-title",className:(0,u.cn)("text-lg font-medium tracking-tight",t),...a})}function f(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"empty-description",className:(0,u.cn)("text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4",t),...a})}function v(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"empty-content",className:(0,u.cn)("flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm",t),...a})}var j=a(32857),b=a(36760),y=a(17799),N=a(39865);let w=e=>{let{releases:t,isLoading:a,installedVersion:r,packageType:l}=e,i=e=>{let t=e.trim();return(t=(t=(t=(t=(t=t.replace(/^### (.*?)$/gm,'<h3 class="text-base font-semibold mt-4 mb-2 text-foreground">$1</h3>').replace(/^## (.*?)$/gm,'<h2 class="text-lg font-bold mt-6 mb-3 text-foreground">$1</h2>').replace(/^# (.*?)$/gm,'<h1 class="text-xl font-bold mt-8 mb-4 text-foreground">$1</h1>')).replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>")).replace(/`(.+?)`/g,'<code class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono">$1</code>')).replace(/^[\*\-]\s+(.+)$/gm,'<li class="ml-6 mb-2 leading-relaxed">$1</li>')).replace(/(<li.*?<\/li>\s*)+/g,e=>'<ul class="list-disc space-y-2 my-3 ml-2">'.concat(e,"</ul>"))).replace(/\n\n+/g,'<div class="mb-4"></div>')},c=e=>{let t=e.replace(/^v/,"").trim().toLowerCase();return"beta"!==l||t.includes("-beta")||(t=t.replace(/\.(\d+)$/,"-beta.$1")),t},o=c(r||""),u=(()=>{if(0===t.length)return[];let e=t[0],a=t.find(e=>c(e.tag_name)===o),s=[];return e&&s.push(e),a&&a.id!==(null==e?void 0:e.id)&&s.push(a),s})();return(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"flex items-center gap-2",children:"Release Notes"}),(0,s.jsx)(n.BT,{children:"Stay informed about the latest changes and improvements in each release."})]}),(0,s.jsx)(n.Wu,{children:a?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(b.E,{className:"h-8 w-3/4"}),(0,s.jsx)(b.E,{className:"h-24 w-full"})]}):u.length>0?(0,s.jsx)("div",{className:"space-y-6",children:u.map(e=>{var a;let r=c(e.tag_name)===o,n=e.id===(null===(a=t[0])||void 0===a?void 0:a.id);return(0,s.jsxs)("div",{className:"border-b pb-4 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.name||e.tag_name,e.prerelease&&(0,s.jsx)("span",{className:"text-xs bg-yellow-500/10 text-yellow-600 dark:text-yellow-400 px-2 py-0.5 rounded-full",children:"Beta"}),n&&(0,s.jsx)("span",{className:"text-xs bg-blue-500/10 text-blue-600 dark:text-blue-400 px-2 py-0.5 rounded-full",children:"Latest"}),r&&(0,s.jsx)("span",{className:"text-xs bg-green-500/10 text-green-600 dark:text-green-400 px-2 py-0.5 rounded-full",children:"Installed"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.published_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,s.jsx)("a",{href:e.html_url,target:"_blank",rel:"noopener noreferrer",children:(0,s.jsxs)(d.$,{variant:"secondary",size:"sm",children:[(0,s.jsx)(N.hL4,{className:"size-4"}),"View on GitHub"]})})]}),(0,s.jsx)("div",{className:"text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:i(e.body||"No release notes available.")}})]},e.id)})}):(0,s.jsx)(m,{className:"from-muted/50 to-background h-full bg-gradient-to-b from-30%",children:(0,s.jsxs)(h,{children:[(0,s.jsx)(g,{variant:"icon",children:(0,s.jsx)(y.A,{})}),(0,s.jsx)(x,{children:"No Release Notes Available"}),(0,s.jsx)(f,{children:"Unable to fetch release notes from GitHub."})]})})})]})},k=()=>{let[e,t]=(0,r.useState)(null),[a,o]=(0,r.useState)(!0),[u,p]=(0,r.useState)(!1),[y,N]=(0,r.useState)(!1),[k,_]=(0,r.useState)(null),[T,A]=(0,r.useState)([]),[S,E]=(0,r.useState)(!0),{toast:C}=(0,j.dj)(),U=async()=>{try{let e=await fetch("https://api.github.com/repos/dr-dolomite/QuecManager-JS/releases",{headers:{Accept:"application/vnd.github.v3+json"}});if(!e.ok)throw Error("Failed to fetch releases");let t=await e.json();A(t)}catch(e){console.error("Error fetching releases:",e),C({title:"Release Notes Unavailable",description:"Could not fetch release notes from GitHub",variant:"destructive"})}finally{E(!1)}},M=async()=>{try{let e=await fetch("/cgi-bin/quecmanager/settings/check_package_info.sh"),a=await e.json();"success"===a.status?(t(a),_(null)):_(a.message||"Failed to fetch package information")}catch(e){_("Network error: Unable to fetch package information"),console.error("Error fetching package info:",e)}finally{o(!1)}},R=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t=await fetch(e?"/cgi-bin/quecmanager/settings/update_package_list.sh?force=1":"/cgi-bin/quecmanager/settings/update_package_list.sh");return await t.json()}catch(e){throw console.error("Error updating package list:",e),e}},$=async()=>{p(!0);try{C({title:"Checking for Updates",description:"Fetching the latest package information..."});let e=await R(!0);if("success"===e.status){let t=Math.floor(e.cache_age_seconds/60),a=e.cache_age_seconds%60,s=t>0?"".concat(t," min ").concat(a,"s"):"".concat(a,"s"),r=e.cached?"Using cached data (".concat(s," old)"):"Package list has been successfully updated.";C({title:"Package List Updated",description:r}),await M()}else C({title:"Update Check Failed",description:e.message||"Failed to update package list",variant:"destructive"})}catch(e){C({title:"Error",description:"Failed to check for updates",variant:"destructive"}),console.error("Error checking for updates:",e)}finally{p(!1)}},F=async()=>{if(null==e?void 0:e.available.update_available){N(!0);try{C({title:"Upgrading",description:"QuecManager is being upgraded. Please wait patiently..."});let t=await fetch("/cgi-bin/quecmanager/settings/upgrade_package.sh"),a=await t.json();"success"===a.status?(C({title:"Upgrade Successful",description:"QuecManager has been upgraded to version ".concat(e.available.version,". The page will now refresh.")}),setTimeout(()=>{window.location.reload()},3e3)):setTimeout(()=>{window.location.reload()},2e3)}catch(e){console.error("Error upgrading package:",e)}finally{N(!1)}}};return((0,r.useEffect)(()=>{C({title:"Checking for Updates",description:"Please wait while we fetch the latest package information...",duration:4e3}),(async()=>{try{await R(!1)}catch(e){console.log("Package list update skipped or failed:",e)}await M()})(),U()},[]),(0,r.useEffect)(()=>{k&&C({title:"Error",description:k,variant:"destructive"})},[k,C]),a)?(0,s.jsxs)("div",{className:"space-y-4 grid",children:[(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"QuecManager Update"}),(0,s.jsx)(n.BT,{children:"Keep your QuecManager up to date with the latest features and improvements."})]}),(0,s.jsx)(n.Wu,{className:"flex items-center justify-center",children:(0,s.jsx)(b.E,{className:"h-64 w-full"})})]}),(0,s.jsx)(w,{releases:[],isLoading:!0,installedVersion:void 0,packageType:void 0})]}):(0,s.jsxs)("div",{className:"space-y-4 grid",children:[(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"flex items-center gap-2",children:"QuecManager Update"}),(0,s.jsx)(n.BT,{children:"Keep your QuecManager up to date with the latest features and improvements."})]}),(0,s.jsx)(n.Wu,{children:(null==e?void 0:e.available.update_available)?(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(m,{className:"from-muted/50 to-background h-full bg-gradient-to-b from-30%",children:[(0,s.jsxs)(h,{children:[(0,s.jsx)(g,{variant:"icon",children:(0,s.jsx)(l.A,{className:"text-primary"})}),(0,s.jsx)(x,{children:"New Update Available"}),(null==e?void 0:e.installed.type)==="beta"?(0,s.jsxs)(f,{children:["A new version of QuecManager ",(0,s.jsx)("strong",{children:"BETA"})," is available."]}):(0,s.jsxs)(f,{children:["A new version of QuecManager ",(0,s.jsx)("strong",{children:"STABLE"})," is available."]}),(0,s.jsxs)(f,{children:["Update from"," ",(0,s.jsx)("strong",{className:"text-blue-500",children:null==e?void 0:e.installed.version})," ","to"," ",(0,s.jsx)("strong",{className:"text-green-500",children:null==e?void 0:e.available.version}),"."]})]}),(0,s.jsx)(v,{children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.$,{onClick:F,disabled:y,children:y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"animate-spin"}),"Upgrading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.A,{}),"Install Update"]})}),(0,s.jsx)(d.$,{variant:"outline",onClick:$,disabled:u,children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"animate-spin"}),"Checking..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{}),"Check Again"]})})]})})]})}):(0,s.jsxs)(m,{className:"from-muted/50 to-background h-full bg-gradient-to-b from-30%",children:[(0,s.jsxs)(h,{children:[(0,s.jsx)(g,{variant:"icon",children:(0,s.jsx)(l.A,{})}),(0,s.jsx)(x,{children:"No Updates Available"}),(0,s.jsxs)(f,{children:["You are running the latest version of QuecManager. Your current version is ","",(null==e?void 0:e.installed.version)?(0,s.jsxs)("strong",{className:"text-blue-500",children:[e.installed.version,"beta"===e.installed.type?(0,s.jsx)("span",{className:"ml-1",children:"BETA"}):(0,s.jsx)("span",{className:"ml-1",children:"STABLE"})]}):(0,s.jsx)(b.E,{className:"ml-1 h-3 w-12 inline-block"}),"."]})]}),(0,s.jsx)(v,{children:(0,s.jsx)(d.$,{onClick:$,disabled:u,children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"animate-spin"}),"Checking..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{}),"Check for Updates"]})})})]})})]}),(0,s.jsx)(w,{releases:T,isLoading:S,installedVersion:null==e?void 0:e.installed.version,packageType:null==e?void 0:e.installed.type})]})}},42541:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>c});var s=a(20475),r=a(20107),n=a(61837),l=a(29395),i=a(22250);let c=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:d=!1,...o}=e,u=d?n.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(c({variant:r,size:l,className:a})),ref:t,...o})});d.displayName="Button"},72167:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>l,aR:()=>i,wL:()=>u});var s=a(20475),r=a(20107),n=a(22250);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},36760:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var s=a(20475),r=a(22250);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-primary/10",t),...a})}},32857:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m,oR:()=>u});var s=a(20107);let r=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],d={toasts:[]};function o(e){d=i(d,e),c.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>o({type:"DISMISS_TOAST",toastId:a});return o({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},22250:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(64901),r=a(868);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[7116,7780,2172,191,6035,7358],()=>t(38224)),_N_E=e.O()}]);